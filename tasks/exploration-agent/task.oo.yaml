inputs_def:
  - handle: input_table
    description: "%input-data-table-for-exploration%"
    json_schema:
      type: object
      properties:
        columns:
          type: array
        rows:
          type: array
        schema:
          type: object
    nullable: false

  - handle: exploration_goal
    description: "%high-level-exploration-goal-e-g-find-insights-about-sales-trends%"
    json_schema:
      type: string
      ui:widget: text
    nullable: false

  - handle: max_iterations
    description: "%maximum-number-of-exploration-iterations%"
    json_schema:
      type: number
    value: 3
    nullable: true

  - handle: llm
    description: "%llm-model-configuration-for-exploration-planning%"
    json_schema:
      ui:widget: llm::model
    value:
      model: oomol-chat
      temperature: 0.3
      max_tokens: 128000
    nullable: false

outputs_def:
  - handle: exploration_steps
    description: "%array-of-exploration-steps-with-transformations-insights-and-cha%"
    json_schema:
      type: array
      items:
        type: object
        properties:
          step_number:
            type: number
          transformation:
            type: string
          insight:
            type: string
          sql_query:
            type: string
          chart_image:
            type: string
          chart_type:
            enum:
              - bar
              - line
              - scatter
              - area
              - pie
              - heatmap
    nullable: false

  - handle: final_report
    description: "%markdown-summary-of-key-findings%"
    json_schema:
      type: string
    nullable: false

  - handle: chart_images
    description: "%all-generated-charts-ready-for-report-generator%"
    json_schema:
      type: array
      items:
        type: object
        properties:
          title:
            type: string
          image:
            type: string
          description:
            type: string
    nullable: false

executor:
  name: python
  options:
    entry: __init__.py
    spawn: false

title: "%exploration-agent%"
icon: ":carbon:explore:"
description: "%autonomous-multi-round-data-exploration-agent-that-discovers-ins%"
